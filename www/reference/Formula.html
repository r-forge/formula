<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extended Formulas: Multiple Responses and Multiple Regressor Parts — Formula • Formula</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Extended Formulas: Multiple Responses and Multiple Regressor Parts — Formula"><meta property="og:description" content="The new class Formula extends the base class
  formula by allowing for multiple responses
  and multiple parts of regressors."><meta property="og:image" content="https://Formula.R-Forge.R-project.org/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@AchimZeileis"><meta name="twitter:site" content="@AchimZeileis"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Formula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2-6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/Formula.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extended Formulas: Multiple Responses and Multiple Regressor Parts</h1>
    
    <div class="hidden name"><code>Formula.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The new class <code>Formula</code> extends the base class
  <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code> by allowing for multiple responses
  and multiple parts of regressors.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Formula</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for Formula</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">x</span>, lhs <span class="op">=</span> <span class="cn">NULL</span>, rhs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  collapse <span class="op">=</span> <span class="cn">FALSE</span>, update <span class="op">=</span> <span class="cn">FALSE</span>, drop <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">as.Formula</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">is.Formula</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object, x</dt>
<dd><p>an object. For <code>Formula</code> it needs to be a
    <code>formula</code> object.</p></dd>

  <dt>lhs, rhs</dt>
<dd><p>indexes specifying which elements of the left- and
    right-hand side, respectively, should be employed. <code>NULL</code>
    corresponds to all parts, <code>0</code> to none.</p></dd>

  <dt>collapse</dt>
<dd><p>logical. Should multiple parts (if any) be collapsed
    to a single part (essentially by replacing the <code>|</code> operator
    by <code>+</code>)? <code>collapse</code> can be a vector of length 2,
    corresponding for different handling of left- and right-hand side
    respectively.</p></dd>

  <dt>update</dt>
<dd><p>logical. Only used if <code>all(collapse)</code>. Should the
    resulting formula be updated to remove possibly redundant terms
    occuring in multiple terms?</p></dd>

  <dt>drop</dt>
<dd><p>logical. Should the <code>Formula</code> class be dropped?
    If <code>TRUE</code> (the default) a <code>formula</code> is returned, if
    <code>FALSE</code> the corresponding <code>Formula</code> is returned.</p></dd>

  <dt>...</dt>
<dd><p>further arguments.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>Formula</code> objects extend the basic <code>formula</code> objects.
  These extensions include multi-part formulas such as
  <code>y ~ x1 + x2 | u1 + u2 + u3 | v1 + v2</code>, multiple response
  formulas <code>y1 + y2 ~ x1 + x2 + x3</code>, multi-part responses
  such as <code>y1 | y2 + y3 ~ x</code>, and combinations of these.</p>  
<p>The <code>Formula</code> creates a <code>Formula</code> object from a <code>formula</code>
  which can have the <code>|</code> operator on the left- and/or right-hand
  side (LHS and/or RHS). Essentially, it stores the original <code>formula</code>
  along with attribute lists containing the decomposed parts for the LHS
  and RHS, respectively.</p>
<p>The main motivation for providing the <code>Formula</code> class is to be
  able to conveniently compute model frames and model matrices or extract
  selected responses based on an extended formula language. This functionality
  is provided by methods to the generics <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></code>,
  and <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></code>. For details and examples, see
  their manual page: <code><a href="model.frame.Formula.html">model.frame.Formula</a></code>.</p>
<p>In addition to these workhorses, a few further methods and functions are provided.
  By default, the <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula()</a></code> method switches back to the original
  <code>formula</code>. Additionally, it allows selection of subsets of the
  LHS and/or RHS (via <code>lhs</code>, and <code>rhs</code>) and collapsing
  multiple parts on the LHS and/or RHS into a single part (via <code>collapse</code>).</p>  
<p><code>is.Formula</code> checks whether the argument inherits from the
  <code>Formula</code> class.</p>  
<p><code>as.Formula</code> is a generic for coercing to <code>Formula</code>, the
  default method first coerces to <code>formula</code> and then calls
  <code>Formula</code>. The default and <code>formula</code> method also take an
  optional <code>env</code> argument, specifying the environment of the resulting
  <code>Formula</code>. In the latter case, this defaults to the environment
  of the <code>formula</code> supplied.</p>  
<p>Methods to further standard generics <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></code>,
  <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></code>, and <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></code> are provided
  for <code>Formula</code> objects. The latter reports the number of parts on
  the LHS and RHS, respectively.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p></p>
<p><code>Formula</code> returns an object of class <code>Formula</code></p>


<p>which inherits from <code>formula</code>. It is the original <code>formula</code></p>


<p>plus two attributes <code>"lhs"</code> and <code>"rhs"</code> that contain the
  parts of the decomposed left- and right-hand side, respectively.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Zeileis A, Croissant Y (2010). Extended Model Formulas in R: Multiple Parts and Multiple Responses.
  <em>Journal of Statistical Software</em>, <b>34</b>(1), 1--13.
  <a href="https://doi.org/10.18637/jss.v034.i01" class="external-link">doi:10.18637/jss.v034.i01</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="model.frame.Formula.html">model.frame.Formula</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## create a simple Formula with one response and two regressor parts</span></span></span>
<span class="r-in"><span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">z1</span> <span class="op">+</span> <span class="va">z2</span> <span class="op">+</span> <span class="va">z3</span></span></span>
<span class="r-in"><span><span class="va">F1</span> <span class="op">&lt;-</span> <span class="fu">Formula</span><span class="op">(</span><span class="va">f1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">F1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Formula" "formula"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">F1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## switch back to original formula</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">F1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ x1 + x2 | z1 + z2 + z3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5643fa92b910&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## create formula with various transformations</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">F1</span>, rhs <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ x1 + x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5643fa92b910&gt;</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">F1</span>, collapse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ x1 + x2 + (z1 + z2 + z3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5643fa92b910&gt;</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">F1</span>, lhs <span class="op">=</span> <span class="fl">0</span>, rhs <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~z1 + z2 + z3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5643fa92b910&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## put it together from its parts</span></span></span>
<span class="r-in"><span><span class="fu">as.Formula</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, <span class="op">~</span> <span class="va">z1</span> <span class="op">+</span> <span class="va">z2</span> <span class="op">+</span> <span class="va">z3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ x1 + x2 | z1 + z2 + z3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5643fa92b910&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## update the formula</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">F1</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">x1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span> <span class="va">.</span> <span class="op">-</span> <span class="va">z2</span> <span class="op">-</span> <span class="va">z3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ x1 + x2 + I(x1^2) | z1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5643fa92b910&gt;</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">F1</span>, <span class="va">.</span> <span class="op">|</span> <span class="va">y2</span> <span class="op">+</span> <span class="va">y3</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y | y2 + y3 ~ x1 + x2 | z1 + z2 + z3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5643fa92b910&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a multi-response multi-part formula</span></span></span>
<span class="r-in"><span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="va">y1</span> <span class="op">|</span> <span class="va">y2</span> <span class="op">+</span> <span class="va">y3</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">x2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span> <span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">|</span> <span class="va">x3</span> <span class="op">/</span> <span class="va">x4</span></span></span>
<span class="r-in"><span><span class="va">F2</span> <span class="op">&lt;-</span> <span class="fu">Formula</span><span class="op">(</span><span class="va">f2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">F2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## obtain various subsets using standard indexing</span></span></span>
<span class="r-in"><span><span class="co">## no lhs, first/seconde rhs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">F2</span>, lhs <span class="op">=</span> <span class="fl">0</span>, rhs <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~x1 + I(x2^2) | 0 + log(x1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5643fa92b910&gt;</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">F2</span>, lhs <span class="op">=</span> <span class="fl">0</span>, rhs <span class="op">=</span> <span class="op">-</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~x1 + I(x2^2) | 0 + log(x1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5643fa92b910&gt;</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">F2</span>, lhs <span class="op">=</span> <span class="fl">0</span>, rhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~x1 + I(x2^2) | 0 + log(x1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5643fa92b910&gt;</span>
<span class="r-in"><span><span class="co">## first lhs, third rhs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">F2</span>, lhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, rhs <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y1 ~ x3/x4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5643fa92b910&gt;</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Achim Zeileis, Yves Croissant.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

